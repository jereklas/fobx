import{a}from"./chunks/chunk-W22DQHDY.js";import{f as e,g as t}from"./chunks/chunk-COHAUUG5.js";e(t(a,{siteInfo:{title:"FobX Documentation",description:"Documentation for FobX state management library",version:"1.0.0",baseUrl:"/fobx"},route:{slug:"core-docs-shallow-observables",path:"/core-docs-shallow-observables",title:"Shallow Observables in FobX",sourcePath:"/fobx/core/docs/shallow-observables.mdoc",parentSlug:"core",lastModified:"2025-06-03T04:18:05.492Z",readingTime:{minutes:4,words:773},frontmatter:{description:"# Shallow Observables in FobX",showEditButton:!0,title:"Shallow Observables in FobX"},content:{ast:{$$mdtype:"Tag",name:"article",attributes:{},children:[{name:"Heading",attributes:{level:1,id:"shallow-observables-in-fobx"},children:["Shallow Observables in FobX"]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["This document explains the different approaches to shallow observables in FobX:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!0},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable({}, {}, { shallowRef: true })"]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:['observable({}, { prop: "observable.shallow" })']}," or"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:['makeObservable({}, { prop: "observable.shallow" })']}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:['observable({}, { prop: "observable.ref" })']}," or"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:['makeObservable({}, { prop: "observable.ref" })']}]}]},{$$mdtype:"Tag",name:"Blockquote",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:[{$$mdtype:"Tag",name:"strong",attributes:{},children:["Note"]},": The ",{$$mdtype:"Tag",name:"code",attributes:{},children:["shallow: true"]}," option has been deprecated and will be removed"," ","in a future version. Please use ",{$$mdtype:"Tag",name:"code",attributes:{},children:["shallowRef: true"]}," instead, which provides the"," ","same functionality."]}]},{name:"Heading",attributes:{level:2,id:"the-three-implementations"},children:["The Three Implementations"]},{name:"Heading",attributes:{level:3,id:"_1-using-observable-with-shallowref-true-option"},children:["1. Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable()"]}," with ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallowRef: true }"]}," option"]},{$$mdtype:"Tag",name:"CodeBlock",attributes:{language:"ts"},children:[`const obj = observable(someObject, {}, { shallowRef: true })

// Deprecated - don't use:
// const obj = observable(someObject, {}, { shallow: true })
`]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["This implementation keeps the original references for all properties of the"," ","object. It makes the properties observable (so changes to the properties"," ","themselves will be tracked), but the properties' values maintain their original"," ","non-observable references."]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["For collections (Arrays, Maps, Sets), this means:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["The collection itself is stored in an observable box"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["The collection is NOT converted to an"," ","ObservableArray/ObservableMap/ObservableSet"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Changes to the collection (adding/removing items) will NOT trigger reactions"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Only replacing the entire collection will trigger reactions"]}]},{name:"Heading",attributes:{level:3,id:"_2-using-observableshallow-annotation"},children:["2. Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.shallow"]}," annotation"]},{$$mdtype:"Tag",name:"CodeBlock",attributes:{language:"ts"},children:[`// With observable()
observable(obj, { prop: "observable.shallow" })

// Or with makeObservable()
makeObservable(obj, { prop: "observable.shallow" })
`]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["This implementation:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Makes the property observable"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["If the property is a collection (Array, Map, Set), it turns it into an"," ","ObservableArray/ObservableMap/ObservableSet with ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallow: true }"]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Changes to the collection (adding/removing items) WILL trigger reactions"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["The items inside the collection maintain their original references (not made"," ","observable)"]}]},{name:"Heading",attributes:{level:3,id:"_3-using-observableref-annotation"},children:["3. Using ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.ref"]}," annotation"]},{$$mdtype:"Tag",name:"CodeBlock",attributes:{language:"ts"},children:[`// With observable()
observable(obj, { prop: "observable.ref" })

// Or with makeObservable()
makeObservable(obj, { prop: "observable.ref" })
`]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["This implementation:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Makes the property observable"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Maintains the original references for property values (like"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallowRef: true }"]},")"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["For collections (Arrays, Maps, Sets), it behaves like ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallowRef: true }"]}," ","option:",{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["The collection is NOT converted to an"," ","ObservableArray/ObservableMap/ObservableSet"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Changes to the collection (adding/removing items) will NOT trigger reactions"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Only replacing the entire collection will trigger reactions"]}]}]}]},{name:"Heading",attributes:{level:2,id:"why-three-different-implementations"},children:["Why Three Different Implementations?"]},{name:"Heading",attributes:{level:3,id:"react-props-use-case"},children:["React Props Use Case"]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["The ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable({}, {}, { shallowRef: true })"]}," implementation and"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.ref"]}," annotation were created specifically to handle React props. In"," ","React components, we want to:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!0},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Observe when props change"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Maintain the original object references for each prop value to preserve"," ","identity and prevent unnecessary renders"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Avoid making the props' values themselves observable, as they come from"," ","parent components and shouldn't be mutated"]}]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["Making collections like arrays non-observable is important in this case because"," ","we want to preserve reference equality and avoid adding reactivity to data that"," ","should be treated as immutable in React."]},{name:"Heading",attributes:{level:3,id:"collection-level-reactivity"},children:["Collection-Level Reactivity"]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["The ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.shallow"]}," annotation approach is useful when:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!0},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["You want to track changes to collections (additions, deletions)"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["But don't want to make the items within those collections observable"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["This provides a good balance between reactivity and performance"]}]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["This is particularly useful for collections where you care about their"," ","composition changing, but the items themselves might be complex objects that you"," ","don't want to make deeply observable."]},{name:"Heading",attributes:{level:2,id:"implementation-details"},children:["Implementation Details"]},{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["In the codebase:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!0},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["For ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable({}, {}, { shallowRef: true })"]},":"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Implementation uses ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observableBox(value, equalityOptions)"]}," for all values"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Values are wrapped directly in an observable box without transformation"]}]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["For ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.shallow"]}," annotation (both with ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable()"]}," and"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:["makeObservable()"]},"):"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Collections are first converted to their observable variants with"," ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallow: true }"]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Then these observable collections are wrapped in an observable box"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["This preserves collection-specific reactivity while keeping collection"," ","items non-observable"]}]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["For ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.ref"]}," annotation:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Implementation is similar to ",{$$mdtype:"Tag",name:"code",attributes:{},children:["{ shallowRef: true }"]}," option but applied as"," ","an annotation"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Creates a direct observable box for the value without transforming it"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Maintains original references of the property values"]}]}]}]},{name:"Heading",attributes:{level:2,id:"when-to-use-which"},children:["When To Use Which"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["Use ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable({}, {}, { shallowRef: true })"]}," when:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Working with React props in a global manner"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Need to maintain reference equality for all properties"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Don't want collection operations to trigger reactions"]}]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["Use ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.ref"]}," annotation when:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Working with specific React props or immutable values"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Need to maintain reference equality for specific properties"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Don't want collection operations to trigger reactions"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Need property-level control rather than object-level control"]}]}]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:[{$$mdtype:"Tag",name:"Paragraph",attributes:{},children:["Use ",{$$mdtype:"Tag",name:"code",attributes:{},children:["observable.shallow"]}," annotation when:"]},{$$mdtype:"Tag",name:"List",attributes:{ordered:!1},children:[{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["You want collection operations (add/delete) to trigger reactions"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["But don't want the items in the collections to become observable"]},{$$mdtype:"Tag",name:"ListItem",attributes:{},children:["Working with class instances or objects with collections that need specific"," ","observable behavior"]}]}]}]}]},toc:[{id:"the-three-implementations",level:2,title:"The Three Implementations",children:[{id:"_1-using-observable-with-shallowref-true-option",level:3,title:"1. Using observable() with { shallowRef: true } option",children:[]},{id:"_2-using-observableshallow-annotation",level:3,title:"2. Using observable.shallow annotation",children:[]},{id:"_3-using-observableref-annotation",level:3,title:"3. Using observable.ref annotation",children:[]}]},{id:"why-three-different-implementations",level:2,title:"Why Three Different Implementations?",children:[{id:"react-props-use-case",level:3,title:"React Props Use Case",children:[]},{id:"collection-level-reactivity",level:3,title:"Collection-Level Reactivity",children:[]}]},{id:"implementation-details",level:2,title:"Implementation Details",children:[]},{id:"when-to-use-which",level:2,title:"When To Use Which",children:[]}]}},navigation:{mainNav:[{label:"Documentation",path:"/"},{label:"GitHub",path:"https://github.com/jereklas/fobx",isExternal:!0}],sidebar:[{title:"Core",items:[{label:"Controlling Comparisons in FobX",path:"/core-docs-controlling-comparisons"},{label:"Creating Observable State in FobX",path:"/core-docs-creating-observable-state"},{label:"Shallow Observables in FobX",path:"/core-docs-shallow-observables"}]}]},lastUpdated:"2025-06-04T06:12:03.194Z"}),document.getElementById("root"));
